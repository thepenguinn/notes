\documentclass[../course]{subfiles}

\begin{document}

\chapter{Simulation of Signals}

\section{Discrete Time Impulse Signal}

Generate and plot a discrete-time impulse signal.

\subsection{Python Implementation}

%python/discreteTimeImpulse.py%
\begin{minted}[breaklines] {python}
    import numpy as np
    import matplotlib.pyplot as plt

    n = np.arange(-5, 6)
    x = np.zeros_like(n)

    x[ n == 0 ] = 1

    plt.stem(n, x)

    plt.xlabel("$n$")
    plt.ylabel("$x[n]$")

    plt.xticks(n)

    plt.savefig("../plots/discreteTimeImpulse.pdf")
\end{minted}

\subsubsection{Plots}

\begin{center}
    \adjustbox{max width = 0.7\textwidth} {
        \includegraphics[height = 0.8\textheight] {plots/discreteTimeImpulse.pdf}
    }
    \captionof {figure} {Discrete Time Impulse Signal}
\end{center}

\section{Discrete Time Pulse Signal}

Generate a discrete-time pulse signal:

\begin{align}
    x[n] =
    \begin{cases}
        \; 1    & \text{; if}\; 0 \leq n \leq 4 \\
        \; 0    & \text{; otherwise}
    \end{cases}
\end{align}

\subsection{Python Implementation}

%python/discreteTimePulse.py%
\begin{minted}[breaklines] {python}
    import numpy as np
    import matplotlib.pyplot as plt

    n = np.arange(-5, 6)
    x = np.zeros_like(n)

    x[(n >= 0) & (n <= 4)] = 1

    plt.stem(n, x)

    plt.xlabel("$n$")
    plt.ylabel("$x[n]$")

    plt.xticks(n)

    plt.savefig("../plots/discreteTimePulse.pdf")
\end{minted}

\subsubsection{Plots}

\begin{center}
    \adjustbox {max width = 0.7\textwidth} {
        \includegraphics[height = 0.8\textheight] {plots/discreteTimePulse.pdf}
    }
    \captionof{figure} {Discrete Time Pulse Signal}
\end{center}


\section{Discrete Time Bipolar Pulse Signal}

Generate and stem the discrete-time bipolar pulse signal:

\begin{align}
    x[n] =
    \begin{cases}
        -1        & \text{; if} -3 \leq n < 0 \\
        \hfill 1  & \text{; if} \hfill 0 \leq n < 3 \\
        \hfill 0  & \text{; otherwise}
    \end{cases}
\end{align}

\subsection{Python Implementation}

%python/discreteTimeBipolar.py%
\begin{minted}[breaklines] {python}
    import numpy as np
    import matplotlib.pyplot as plt

    n = np.arange(-5, 6)
    x = np.zeros_like(n)

    x[(n >= -3) & (n < 0)] = -1
    x[(n >= 0) & (n < 3)] = 1

    plt.stem(n, x)

    plt.xlabel("$n$")
    plt.ylabel("$x[n]$")

    plt.xticks(n)

    plt.savefig("../plots/discreteTimeBipolar.pdf")
\end{minted}

\subsubsection{Plots}

\begin{center}
    \adjustbox {max width = 0.7\textwidth} {
        \includegraphics[height = 0.8\textheight] {plots/discreteTimeBipolar.pdf}
    }
    \captionof{figure} {Discrete Time Bipolar Pulse Signal}
\end{center}

\section{Discrete Time Ramp Signal}

Generate and plot a discrete-time ramp signal.

\begin{align}
    x[n] =
    \begin{cases}
        n         & \text{; if} \; n \geq 0 \\
        \hfill 0  & \text{; if} \; n < 0
    \end{cases}
\end{align}

\subsection{Python Implementation}

%python/discreteTimeRamp.py%
\begin{minted}[breaklines] {python}
    import numpy as np
    import matplotlib.pyplot as plt

    n = np.arange(0, 11)
    x = n.copy()

    plt.stem(n, x)

    plt.xlabel("$n$")
    plt.ylabel("$x[n]$")

    plt.xticks(n)

    plt.savefig("../plots/discreteTimeRamp.pdf")
\end{minted}

\subsubsection{Plots}

\begin{center}
    \adjustbox {max width = 0.7\textwidth} {
        \includegraphics[height = 0.8\textheight] {plots/discreteTimeRamp.pdf}
    }
    \captionof{figure} {Discrete Time Ramp Signal}
\end{center}

\section{Discrete Time Triangluar Signal}

Generate a triangluar signal.

\begin{align}
    x[n] = \{0, 1, 2, 3, 4, 5, 4, 3, 2, 1, 0\}
\end{align}

\subsection{Python Implementation}

%python/discreteTimeTri.py%
\begin{minted}[breaklines] {python}
    import numpy as np
    import matplotlib.pyplot as plt

    a = np.arange(6)
    b = np.arange(4, -1, -1)

    x = np.concatenate([a, b])

    plt.stem(x)

    plt.xlabel("$n$")
    plt.ylabel("$x[n]$")

    plt.xticks(np.arange(11))

    plt.savefig("../plots/discreteTimeTri.pdf")
\end{minted}

\subsubsection{Plots}

\begin{center}
    \adjustbox {max width = 0.7\textwidth} {
        \includegraphics[height = 0.8\textheight] {plots/discreteTimeTri.pdf}
    }
    \captionof{figure} {Discrete Time Triangluar Signal}
\end{center}

\section{Yet Another Discrete Time Signal}

Plot the discrete-time signal $x[n] = \{2, -1, 4, 1\}$ using
\mintinline[]{python}{plt.stem()}. Use \mintinline[]{python}{np.array} to
create \mintinline[]{python}{x}.


\subsection{Python Implementation}

%python/yetAnotherDiscreteTimeSignal.py%
\begin{minted}[breaklines] {python}
    import numpy as np
    import matplotlib.pyplot as plt

    x = np.array([2, -1, 4, 1])

    plt.xlabel("$n$")
    plt.ylabel("$x[n]$")

    plt.stem(x)

    plt.savefig("../plots/yetAnotherDiscreteTimeSignal.pdf")
\end{minted}

\subsubsection{Plots}

\begin{center}
    \adjustbox {max width = 0.7\textwidth} {
        \includegraphics[height = 0.8\textheight] {plots/yetAnotherDiscreteTimeSignal.pdf}
    }
    \captionof{figure} {Yet Another Discrete Time Signal}
\end{center}

\section{Complex Exponential Sequence}

Generate the complex exponential sequence:

\begin{align}
    x[n] = e^{\bigg( -\dfrac{1}{12} + \dfrac{j \pi n}{6} \bigg)}
\end{align}

Display both the real and imaginary parts of the signal from $n=0$ to $n=40$
using \mintinline[]{python}{plt.subplot()}.

\subsection{Python Implementation}

%python/complexExpSeq.py%
\begin{minted}[breaklines] {python}
    import numpy as np
    import matplotlib.pyplot as plt

    def comp_exp_func (n):
        return np.exp( (-1 / 12) + (1j * np.pi / 6 * n) )

    t = np.arange(0, 41)
    x = comp_exp_func(t)

    plt.figure(figsize = (10, 16))

    plt.subplot(2, 1, 1)
    plt.stem(t, x.real, label = "Real part")
    plt.legend()

    plt.subplot(2, 1, 2)
    plt.stem(t, x.imag, label = "Imaginary part")
    plt.legend()

    plt.savefig("../plots/complexExpSeq.pdf")
\end{minted}

\subsubsection{Plots}

\begin{center}
    \adjustbox {max width = 0.7\textwidth} {
        \includegraphics[height = 0.8\textheight] {plots/complexExpSeq.pdf}
    }
    \captionof{figure} {Complex Exponential Sequence}
\end{center}

\section{Yet Another Sequence}

Generate the below signal for $n=0$ to $n=50$:

\begin{align}
    x[n] = (0.95)^{n}\cos(0.1 \pi n)
\end{align}

\subsection{Python Implementation}

%python/yetAnotherSeq.py%
\begin{minted}[breaklines] {python}
    import numpy as np
    import matplotlib.pyplot as plt

    def yet_another_func(n):
        return (0.95 ** n) * np.cos(0.1 * np.pi * n)

    t = np.arange(0, 51)
    x = yet_another_func(t)

    plt.stem(t, x)

    plt.xlabel("$n$")
    plt.ylabel("$x[n]$")

    plt.savefig("../plots/yetAnotherSeq.pdf")
\end{minted}

\subsubsection{Plots}

\begin{center}
    \adjustbox {max width = 0.7\textwidth} {
        \includegraphics[height = 0.8\textheight] {plots/yetAnotherSeq.pdf}
    }
    \captionof{figure} {Yet Another Sequence}
\end{center}

\section{Many more Discrete Sequences}

Generate $50$ samples of the following discrete time sequences and display
using stem:

\begin{align}
    x[n] = 20(0.9)^{n}
\end{align}

\begin{align}
    x[n] = 0.2(1.2)^{n}
\end{align}

\begin{align}
    x[n] = (-0.8)^{n}
\end{align}

\begin{align}
    x[n] = -4(0.8)^{n}
\end{align}

\begin{align}
    x[n] = 2n(0.9)^{n}
\end{align}

\subsection{Python Implementation}

%python/manyMoreSeq.py%
\begin{minted}[breaklines] {python}
    import numpy as np
    import matplotlib.pyplot as plt

    def func_a (n):
        return 20 * (0.9 ** n)

    def func_b (n):
        return 0.2 * (1.2 ** n)

    def func_c (n):
        return (-0.8 ** n)

    def func_d (n):
        return -4 * (0.8 ** n)

    def func_e (n):
        return 2 * n * (0.9 ** n)

    t = np.arange(0, 51)
    a = func_a(t)
    b = func_b(t)
    c = func_c(t)
    d = func_d(t)
    e = func_e(t)

    plt.figure(figsize = (10, 20))

    plt.subplot(5, 1, 1)
    plt.stem(t, a)

    plt.subplot(5, 1, 2)
    plt.stem(t, b)

    plt.subplot(5, 1, 3)
    plt.stem(t, c)

    plt.subplot(5, 1, 4)
    plt.stem(t, d)

    plt.subplot(5, 1, 5)
    plt.stem(t, e)

    plt.savefig("../plots/manyMoreSeq.pdf")
\end{minted}

\subsubsection{Plots}

\begin{center}
    \adjustbox {max width = 0.7\textwidth} {
        \includegraphics[height = 0.8\textheight] {plots/manyMoreSeq.pdf}
    }
    \captionof{figure} {Many more Discrete Sequences}
\end{center}

\section{Discrete Time Sinosoids}

Generate the discrete-time sinosoids and compare the plots generated for the
three cases and comment on your result:

\begin{align}
    x_{1}[n] = \sin(0.2 \pi n)
\end{align}

\begin{align}
    x_{2}[n] = \sin(1.8 \pi n)
\end{align}

\begin{align}
    x_{3}[n] = \sin(2.2 \pi n)
\end{align}

\subsection{Python Implementation}

%python/discreteTimeSinusoids.py%
\begin{minted}[breaklines] {python}
    import numpy as np
    import matplotlib.pyplot as plt

    def func_a (n):
        return np.sin(0.2 * np.pi * n)

    def func_b (n):
        return np.sin(1.8 * np.pi * n)

    def func_c (n):
        return np.sin(2.2 * np.pi * n)

    t = np.arange(0, 51)
    a = func_a(t)
    b = func_b(t)
    c = func_c(t)

    plt.figure(figsize = (10, 20))

    plt.subplot(3, 1, 1)
    plt.stem(t, a)

    plt.xlabel("$n$")
    plt.ylabel("$x_{1}[n] = \\sin(0.2 \\pi n)$")

    plt.subplot(3, 1, 2)
    plt.stem(t, b)

    plt.xlabel("$n$")
    plt.ylabel("$x_{2}[n] = \\sin(1.8 \\pi n)$")

    plt.subplot(3, 1, 3)
    plt.stem(t, c)

    plt.xlabel("$n$")
    plt.ylabel("$x_{3}[n] = \\sin(2.2 \\pi n)$")

    plt.savefig("../plots/discreteTimeSinusoids.pdf")
\end{minted}

\subsubsection{Plots}

\begin{center}
    \adjustbox {max width = 0.7\textwidth} {
        \includegraphics[height = 0.8\textheight] {plots/discreteTimeSinusoids.pdf}
    }
    \captionof{figure} {Discrete Time Sinosoids}
\end{center}

\section{Continuous Time Signals}

Even though all signals that we generate on a digital computer are
necessarily discrete, we can simulate a continuous time signal by sampling at
a high rate and graphing it as a continuous curve using \mintinline[]{text}{plt.plot()}.


\subsection{Python Implementation}

%python/continousTimeSignals.py%
\begin{minted}[breaklines] {python}
    import numpy as np
    import matplotlib.pyplot as plt

    t = np.arange(0, 1, 0.02)
    x = np.sin(2 * np.pi * 1 * t)
    y = np.sin(2 * np.pi * 2 * t)

    plt.plot(t, x, label = "1 Hz")
    plt.plot(t, y, label = "2 Hz")

    plt.xlabel("$t$")
    plt.ylabel("$\\sin (2 \\pi f t)$")

    plt.legend()

    plt.savefig("../plots/continousTimeSignals.pdf")
\end{minted}

\subsubsection{Plots}

\begin{center}
    \adjustbox {max width = 0.7\textwidth} {
        \includegraphics[height = 0.8\textheight] {plots/continousTimeSignals.pdf}
    }
    \captionof{figure} {Continuous Time Signals}
\end{center}

\section{Rectified Sine Wave}

Generate and plot a sine wave and the full wave rectified version:

\begin{align}
    x(t) =
    \begin{cases}
        \; \sin(t) & \text{; if} \; -2\pi \leq t \leq 2\pi \\
        \hfill 0   & \text{; otherwise}
    \end{cases}
\end{align}

\subsection{Python Implementation}

%python/rectifiedSine.py%
\begin{minted}[breaklines] {python}
    import numpy as np
    import matplotlib.pyplot as plt

    t = np.linspace(-2 * np.pi, 2 * np.pi, 300)
    x = np.sin(t)

    plt.figure(figsize = (6, 11))

    values = np.arange(- 2 * np.pi, 2.5 * np.pi, np.pi / 2)

    labels = [
        "$- 2 \\pi$", "$- \\dfrac{3 \\pi}{2}$", "$- \\pi$", "$- \\dfrac{\\pi}{2}$",
        "$0$",
        "$\\dfrac{\\pi}{2}$", "$\\pi$", "$\\dfrac{3 \\pi}{2}$", "$2 \\pi$"
    ]

    plt.subplot(2, 1, 1)
    plt.plot(t, x)

    plt.title("Sine Wave")
    plt.xticks(values, labels)

    plt.xlabel("$t$")
    plt.ylabel("$\\sin (t)$")

    plt.subplot(2, 1, 2)
    plt.plot(t, abs(x))

    plt.title("Full Rectified Sine Wave")
    plt.xticks(values, labels)

    plt.xlabel("$t$")
    plt.ylabel("$x(t)$")

    plt.savefig("../plots/rectifiedSine.pdf")
\end{minted}

\subsubsection{Plots}

\begin{center}
    \adjustbox {max width = 0.7\textwidth} {
        \includegraphics[height = 0.8\textheight] {plots/rectifiedSine.pdf}
    }
    \captionof{figure} {Rectified Sine Wave}
\end{center}

\section{Random Signals}

Random signals: A random signal of length N with samples uniformly distributed
in the interval $[0,1)$ can be generated by usning the command
\mintinline[]{text}{x = np.random.random_sample(N)}. Generate and display a
random signal of length $100$ whose elements are distributed in the interval
$[-2,2)$.

\subsection{Python Implementation}

%python/randomSignals.py%
\begin{minted}[breaklines] {python}
    import numpy as np
    import matplotlib.pyplot as plt

    x = np.random.random_sample(100)
    x = (x * 4) - 2

    plt.stem(x)

    plt.xlabel("Time")
    plt.ylabel("Amplitude")

    plt.savefig("../plots/randomSignals.pdf")
\end{minted}

\subsubsection{Plots}

\begin{center}
    \adjustbox {max width = 0.7\textwidth} {
        \includegraphics[height = 0.8\textheight] {plots/randomSignals.pdf}
    }
    \captionof{figure} {Random Signals}
\end{center}

\section{More Random Signals}

Likewise, a random signal $x[n]$ of length $N$ with samples normally
distributed with zero mean and unity standard deviation can be generated by
using the following command \mintinline[]{text}{x = np.random.normal(0.0, 1.0, N)}.

Generate and display a Gaussian random signal of length $75$  whose elements
are normally distributed with zero mean and a variance of $3$. And verify the
results with \mintinline[]{text}{np.mean()} and \mintinline[]{text}{np.var()}.

\subsection{Python Implementation}

%python/moreRandomSignals.py%
\begin{minted}[breaklines] {python}
    import numpy as np
    import matplotlib.pyplot as plt

    x = np.random.normal(0.0, np.sqrt(3), 75)

    plt.stem(x)

    plt.xlabel("Time")
    plt.ylabel("Amplitude")

    print("Mean of the random signal: " + str(np.mean(x)))
    print("Variance of the random signal: " + str(np.var(x)))

    plt.savefig("../plots/moreRandomSignals.pdf")
\end{minted}

\subsubsection{Output}

\begin{minted}[breaklines] {text}
    Mean of the random signal: -0.0148829771748769
    Variance of the random signal: 2.5605317118401776
\end{minted}

\subsubsection{Plots}

\begin{center}
    \adjustbox {max width = 0.7\textwidth} {
        \includegraphics[height = 0.8\textheight] {plots/moreRandomSignals.pdf}
    }
    \captionof{figure} {More Random Signals}
\end{center}

\section{Sine Wave Corrupted with Noise}

Generate and plot a sinewave corrupted with zero mean Gaussian noise. And
plot the noisy signal for various values of std dev for the noise.

\subsection{Python Implementation}

%python/corruptedSineWave.py%
\begin{minted}[breaklines] {python}
    import numpy as np
    import matplotlib.pyplot as plt

    def corrupt_signal(sig, sdev):
        noise = np.random.normal(0, sdev, sig.size)
        return sig + noise

    sdevs = [0.2, 0.7, 1.3]

    t = np.arange(0, 2, 0.01)
    signal = np.sin(2 * np.pi * t)

    plt.figure(figsize = (10, 20))

    plt.subplot(len(sdevs) + 1, 1, 1)
    plt.plot(t, signal, label = "Original signal")
    plt.legend()

    for i in range(len(sdevs)):
        noisy_signal = corrupt_signal(signal, sdevs[i])
        plt.subplot(len(sdevs) + 1, 1, i + 2)
        plt.plot(
            t, noisy_signal,
            label = "Corrupted signal with gaussian noise of " + str(sdevs[i]) + " sdev"
        )
        plt.legend()

    plt.savefig("../plots/corruptedSineWave.pdf")
\end{minted}

\subsubsection{Plots}

\begin{center}
    \adjustbox {max width = 0.7\textwidth} {
        \includegraphics[height = 0.8\textheight] {plots/corruptedSineWave.pdf}
    }
    \captionof{figure} {Sine Wave Corrupted with Noise}
\end{center}

\end{document}
